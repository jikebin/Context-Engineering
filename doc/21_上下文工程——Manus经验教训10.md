# 上下文卸载的终极进化：从卸载“数据”到卸载“工具”

## 问题提出

当Agent当工具库变得异常庞大时，将所有工具定义都放入上下文，会导致“上下文混淆”，模型会“眼花撩乱”，更容易调用错误。

## 破局之道

Manus的答案：不再动态加载工具，而是卸载工具本身。通过设计一个全新的“分层行动空间”。

>核心思想：让Agent的直接行动空间保持极简，将复杂性分层卸载到外部环境。

## “分层行动空间”三层架构解析

### 第一层：函数调用(原子操作)

* 定位：与模型直接交互的唯一接口。
* 内容：极少数、固定的原子函数(`read/write_file`,`execute_shell`).
* 权衡：+可靠性 & +高性能 vs -灵活性。
* 类比：Agent的“内置快捷键”。

### 第二层：沙盒工具(命令行程序)

* 定位：能力扩展的主力层。
* 机制：通过`execute_shell`调用；通过`ls` 和 `help`自主发现和学习。
* 权衡：+扩展性 & +异步处理 vs -低延迟交互。
* 类比：Agent的“外部工具箱”。

### 第三层：包与API(编写和执行代码)

* 定位：终极能力层，处理未知问题。
* 机制：组合第一层工具，自主编写并执行python脚本，调用任意库。
* 权衡：+无限能力 vs -模式安全性。
* 类比：Agent的“完整编程环境”。

## 统一接口：分层架构的终极优雅

从模型的视角来看，它完全不知道有“三层”的存在。
无论任务多复杂，它最终都只调用第一层那几个固定的原子函数。

### 最终收益

* 接口干净：行动空间使用简洁，杜绝”上下文混淆“。
* 缓存友好：固定接口最大化KV缓存效用，保证高性能。
* 正交设计：不同层次能力解耦，系统清晰、易于维护。