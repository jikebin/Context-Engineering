# Agent的专注力法则：用“复述”对抗遗忘

问题定义：复杂任务中的“目标漂移”

## 核心挑战：“迷失在中间”

* 场景背景：一个典型任务平均需要50次工具调用，是一个极长的行动链。
* 根本原因：Transformer对上下文的开头和结尾最敏感，对呗淹没在**中间**部分的信息容易忽略。

## 常规方法的局限

* 辨析：为什么不直接把目标写死在System Prompt里？
* 核心原因：注意力稀释（Attention Dilution）.
* 写在开头的静态目标，在极长的上下文中，其注意力信号会变得极其微弱，在决策时被更近、更强的信号所淹没。

## 具体实现：`todo.md`的复述循环

### 写入/更新循环

Agent通过`write`工具，在两个关键时机主动更新`todo.md`:

```md
1.初始规划：
收到复杂任务后，Agent分解计划并首次写入`todo.md`.
write("todo.md", "- [ ] 搜索SSM...")
```

```md
2.核心复述：
每完成一个子任务，就用包含最新进度的完整列表，重写覆盖`todo.md`
write("todo.md", "- [x] 搜索SSM...")
```

### 使用/决策循环

在每个决策循环的开始，Agent会基于上下文**最末尾**的`todo.md`内容进行思考：

```md
1.读取计划：“OK，第一项已完成。”
2.确定任务：“下一个任务是 ‘总结优缺点’。”
3.制定行动：“因此，我的下一步行动应该是...”
```

## 工作原理与最终收益

### 工作原理：利用注意力特性

在“只追加”架构中，每次重写`todo.md`的动作，都会将完整的动态计划推送到上下文序列的最末端。

这就巧妙地将最重要的导航信息，始终置于模型注意力最强的“近期注意力范围”之内。

### 最终收益

* 高效对抗遗忘：解决了长任务链中的“目标漂移”问题。
* 实现简单优雅：无需修改架构，通过引导行为和工具实现。
* 提升Agent心智：进化成会计划、会回顾、会纠偏的“项目经理”。